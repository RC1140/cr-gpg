<script src="jquery-1.6.1.min.js"></script>
<script src="jquery-ui-1.8.13.custom.js"></script>
<link rel=StyleSheet href="jquery-ui-1.8.11.thinkst.css" type="text/css">
<script>
    $(document).ready(function(){
        function plugin0()
        {
            return document.getElementById('plugin0');
        }
        $('a.encrypt').click(function(){
            chrome.extension.sendRequest({'messageType':'encrypt',encrypt: {'message':$('#ecmessage').val(),'maillist':$('#recipients').val().split(','),'domel':$(this).attr('id')}}, function(response) {
                var returnMessage = response.message;
                $('#ecmessage').text(returnMessage);   
            });
        });

        $('a.import').click(function(){
            var gpgPath = localStorage['gpgPath'];
            var tempPath = localStorage['tempPath'];
            if(!gpgPath){
                gpgPath = '/opt/local/bin/'; 
            };
            if(!tempPath){
                tempPath = '/tmp/'; 
            }
            plugin0().appPath = gpgPath;
            plugin0().tempPath = tempPath;
            $('textarea').text(plugin0().importKey($('textarea.message').val()));   
        });
        $('textarea').click(function(){
            if($(this).text() == 'Enter text here'){
                $(this).text(''); 
                return;
            };
            if($(this).text() == 'Please Paste your key here'){
                $(this).text(''); 
                return;
            };

        });
        $(function() {
            $( "#tabs" ).tabs();
        });
    });
</script>
<div class="interface">
    <div id="tabs">
        <ul>
            <li><a href="#tabs-1">Import Key</a></li>
            <li><a href="#tabs-2">Encrypt Text</a></li>
        </ul>
        <div id="tabs-1">
            <h3>If you need to import a users key , please paste the ascii armor formatted key below</h3>
            <div width="280px" height="200px">
                <form>
                    Key : 
                    <textarea class="message" rows="10" cols="75">Please Paste your key here</textarea>
                    <a class="import" href="#">Import Key</a> 
                </form>
            </div>
        </div>
        <div id="tabs-2">
            <h3>Encrypt Text</h3>
            <div width="280px" height="200px">
                <form>
                    Recipients (comma seperated) : 
                    <input id="recipients" width="100%"/><br/>
                    Message : 
                    <textarea id="ecmessage" rows="10" cols="75">Enter text here</textarea>
                    <a class="encrypt" id="2002"  href="#">Encrypt Text</a> 
                </form>
            </div>

        </div>
    </div>
</div>
<object height="1px" id="plugin0" type="application/x-gmailgpg"></object><br />
